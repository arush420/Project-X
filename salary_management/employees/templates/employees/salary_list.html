{% extends 'base.html' %}

{% block title %}Salary List{% endblock %}

{% block content %}
    <h1>Generated Salaries</h1>

    <!-- Filter form -->
    <form method="GET">
        <label for="month">Month:</label>
        <select name="month" id="month">
            <option value="">All</option>
            {% for month_num, month_name in month_choices %}
                <option value="{{ month_num }}" {% if month == month_num|stringformat:"s" %}selected{% endif %}>
                    {{ month_name }}
                </option>
            {% endfor %}
        </select>

        <label for="year">Year:</label>
        <input type="number" name="year" value="{{ year|default_if_none:'' }}" placeholder="Year">

        <button type="submit">Filter</button>
    </form>

    <!-- Print and Download Buttons -->
    <div style="margin-top: 20px;">
        <button onclick="window.print()">Print</button>
        <a href="/employees/salary/download-csv/?month={{ month }}&year={{ year }}" target="_blank">
            <button type="button">Download CSV</button>
        </a>
    </div>

    <!-- Salary Table -->
    <table border="1">
        <thead>
            <tr>
                <th>Employee Name</th>
                <th>Month</th>
                <th>Year</th>
                <th>Basic Salary</th>
                <th>Transport</th>
                <th>Canteen</th>
                <th>PF</th>
                <th>ESIC</th>
                <th>Advance Deduction</th>
                <th>Gross Salary</th>
                <th>Net Salary</th>
                <th>Date Generated</th>
            </tr>
        </thead>
        <tbody>
            {% for salary in salaries %}
            <tr>
                <td>{{ salary.employee.name }}</td>
                <td>{{ salary.get_month_display }}</td>
                <td>{{ salary.year }}</td>
                <td>{{ salary.basic_salary }}</td>
                <td>{{ salary.transport }}</td>
                <td>{{ salary.canteen }}</td>
                <td>{{ salary.pf }}</td>
                <td>{{ salary.esic }}</td>
                <td>{{ salary.advance_deduction }}</td>
                <td>{{ salary.gross_salary }}</td>
                <td>{{ salary.net_salary }}</td>
                <td>{{ salary.date_generated }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="12">No salaries found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
